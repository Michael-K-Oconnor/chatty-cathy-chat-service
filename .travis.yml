sudo: required
services:
  - docker

branches:
  only:
    - master
    - development

before_script:
  - sh scripts/travis-check-version.sh
  - sh scripts/travis-install.sh
  - ls ${HOME}/.kube
  - ls ${HOME}/.kube/config
  - cat ${HOME}/.kube/config
  - docker pull michaelkoconnor/chatty-cathy || true

script:
  - sh scripts/travis-build.sh

after_script:
  - docker images

before_deploy:
  - docker login -u "michaelkoconnor" -p "${DOCKERHUB_PASS}"

deploy:
  provider: script
  script: docker push michaelkoconnor/chatty-cathy
  on:
    branch: master
